# 错误码设计规范

## 设计原则

- **易读性**: 5 位数字分段式，便于快速识别错误类型
- **唯一性**: 每个错误码全局唯一，避免歧义
- **分类明确**: 按层级和模块划分，易于扩展

---

## 错误码结构（ABBCC 格式）

```
A    BB         CC
│    │          │
│    │          └─ 具体错误流水号 (01-99)
│    └──────────── 模块级 (01=通用, 01=用户, 02=角色, 03=菜单, 04=部门, 05=字典, 06=认证, 07=文件)
└───────────────── 服务/大类级 (0=成功, 1=系统级, 2=业务级, 3=三方服务)
```

---

## 错误码分类

### 首位分类

| 首位 | 分类 | 说明 | 示例 |
|------|------|------|------|
| 0 | 成功 | 操作成功 | 00000 |
| 1 | 系统级错误 | 参数、权限、限流等通用错误 | 10001=参数错误, 10002=未授权 |
| 2 | 业务级错误 | 业务逻辑错误（用户、角色、菜单等） | 20101=用户不存在, 20201=角色不存在 |
| 3 | 三方服务错误 | 数据库、Redis、短信平台等 | 30101=数据库错误, 30301=短信失败 |

---

## 模块划分（BB 部分）

| 模块码 | 模块名称 | 错误码范围 | 说明 |
|--------|----------|------------|------|
| 00 | 通用模块 | 10000-10099 | 系统级通用错误 |
| 01 | 用户模块 | 20100-20199 | 用户登录、注册、信息管理 |
| 02 | 角色模块 | 20200-20299 | 角色管理、权限分配 |
| 03 | 菜单模块 | 20300-20399 | 菜单管理、权限树 |
| 04 | 部门模块 | 20400-20499 | 部门管理、组织架构 |
| 05 | 字典模块 | 20500-20599 | 字典类型、字典数据 |
| 06 | 认证模块 | 20600-20699 | Token、设备、验证码 |
| 07 | 文件模块 | 20700-20799 | 文件上传、下载、管理 |
| 01 | 数据库 | 30100-30199 | 三方服务：数据库 |
| 02 | Redis | 30200-30299 | 三方服务：Redis |
| 03 | 短信服务 | 30300-30399 | 三方服务：短信 |

---

## 使用示例

### 成功响应
```java
ApiResponse.success(data);  // code: 0
```

### 系统级错误
```java
throw new EzBusinessException(ErrorCode.BAD_REQUEST);  // 10001
throw new EzBusinessException(ErrorCode.UNAUTHORIZED);  // 10002
```

### 业务级错误
```java
throw new EzBusinessException(ErrorCode.USER_NOT_FOUND);  // 20101
throw new EzBusinessException(ErrorCode.ROLE_NOT_FOUND);  // 20201
```

### 三方服务错误
```java
throw new EzBusinessException(ErrorCode.DATABASE_ERROR);  // 30101
throw new EzBusinessException(ErrorCode.SMS_SEND_ERROR);   // 30301
```

---

## 响应体格式

```json
{
  "code": 20101,
  "message": "用户不存在",
  "data": null,
  "timestamp": 1705978432000
}
```

---

## 常用错误码速查

### 系统级错误（1xxxx）
| 错误码 | 说明 |
|-------|------|
| 10001 | 参数错误 |
| 10002 | 未授权 |
| 10003 | 禁止访问 |
| 10004 | 资源不存在 |
| 10005 | 请求方法不支持 |

### 用户模块（201xx）
| 错误码 | 说明 |
|-------|------|
| 20101 | 用户不存在 |
| 20102 | 用户名已存在 |
| 20103 | 密码错误 |
| 20104 | 用户已被禁用 |

### 角色模块（202xx）
| 错误码 | 说明 |
|-------|------|
| 20201 | 角色不存在 |
| 20202 | 角色名已存在 |
| 20203 | 角色已被使用，无法删除 |

### 菜单模块（203xx）
| 错误码 | 说明 |
|-------|------|
| 20301 | 菜单不存在 |
| 20302 | 菜单已存在子菜单，无法删除 |
| 20303 | 父菜单不存在 |

### 部门模块（204xx）
| 错误码 | 说明 |
|-------|------|
| 20401 | 部门不存在 |
| 20402 | 部门已存在子部门，无法删除 |
| 20403 | 部门下存在用户，无法删除 |

### 字典模块（205xx）
| 错误码 | 说明 |
|-------|------|
| 20501 | 字典类型不存在 |
| 20502 | 字典类型已存在 |
| 20503 | 字典数据不存在 |
